/*!
 * barick-tilify v1.0.0 (https://github.com/codotronix/barick-tilify)
 * Copyright 2016 Suman Barick
 * Licensed under the MIT license
 */
var tile_plugins={};!function($){$.fn.tilify=function(TM,btn_toggleTileDnD,btn_toggleTileResize){return this.each(function(){function init(){calculateWidths(),noBigTileInXS(),makeGrids(),mapTilesToGrid(),drawTiles(),setStyles(),wakeUpLive(),bindDragAndDrop(),enableTileResize()}function reTilify(){resetGrids(),mapTilesToGrid(),drawTiles(),setStyles()}function drawTiles(){var e="";container.addClass("tiles-container "+page_Width_Class);var i;for(var l in tiles)i=tiles[l],e+='<div id="'+i.id+'" class="tile '+i.size+'" style="top:'+i.top+"px; left:"+i.left+'px;" data-gridid="'+i.gridId+'" ><a class="tileInnerContainer" target="_blank" href="'+(i.link||"javascript:void(0)")+'" style="background: '+i.bgColor+';" >',"font"==i.iconType?e+='<span class="fontIcon '+i.icon+'"></span>':"live"==i.iconType?(e+='<div class="live">',void 0!=i.liveImgUrls&&(e+='<img  class="fontImg" src="'+i.liveImgUrls[0]+'" />'),void 0!=i.liveTxts&&(e+='<span class="liveTxt" style="color:'+i.fontColor+'">'+i.liveTxts[0]+"</span>"),e+="</div>"):"plugin"==i.iconType&&(e+='<div class="plugin"></div>'),e+='<label class="name">'+i.name+"</label>",e+="</a></div>";e+='<div style="position:absolute; left: 10px; right: 10px; height: 80px; top: '+(clearSpaceDivPosition+50)+'px" ></div>',container.html(e),loadPlugins()}function loadPlugins(){for(var i in tiles)"plugin"==tiles[i].iconType&&(tile_plugins[tiles[i].id]=tile_plugins[tiles[i].id]||{},tile_plugins[tiles[i].id].initFunc?eval(tile_plugins[tiles[i].id].initFunc):fetchPlugin(tiles[i].id))}function fetchPlugin(e){var i="tile_plugins/"+e+"/index.js";$.getScript(i,function(i,l,t){tile_plugins[e].initFunc=i})}function setStyles(){$(".tile.small").css({width:small_tile_size,height:small_tile_size}),$(".tile.medium").css({width:medium_tile_size,height:medium_tile_size}),$(".tile.big").css({width:big_tile_size,height:big_tile_size}),$(".tile.rectangle").css({width:big_tile_size,height:medium_tile_size}),$(".tile .fontIcon").each(function(){var e=$(this).closest(".tile").height();$(this).css({"font-size":e/2+"px","margin-top":e/8+"px"})})}function wakeUpLive(){var e=["slideInDown","slideInLeft","slideInRight","slideInUp","rotateIn","rollIn","zoomIn"],i=["fadeIn"];$(".tile .live").each(function(){function l(){tileMovementAllowed||tileResizeAllowed||(a=(a+1)%r,d=e[Math.floor(Math.random()*e.length)],$("#"+s).find(".fontImg").attr("src",o[a]).removeClass().addClass("fontImg animated "+d)),setTimeout(l,g)}function t(){tileMovementAllowed||tileResizeAllowed||(c=(c+1)%f,d=i[Math.floor(Math.random()*i.length)],$("#"+s).find(".liveTxt").text(n[c]).removeClass().addClass("liveTxt animated "+d)),setTimeout(t,g)}var s=$(this).closest(".tile").attr("id"),o=tiles[s].liveImgUrls,n=tiles[s].liveTxts;if(void 0!=o&&o.length>1){var a=0,r=o.length,d="",g=2500+Math.round(Math.random()*(5e3/r));l()}if(void 0!=n&&n.length>1){var c=0,f=n.length,d="",g=2500+Math.round(Math.random()*(5e3/f));t()}})}function calculateWidths(){var e=20,i=containerWidth-e;page_Width_Class="xs";gridsPerRow=12,small_tile_size=Math.floor(i/gridsPerRow),i>=1200?(page_Width_Class="lg",gridsPerRow=16,small_tile_size=Math.floor(i/gridsPerRow)):i>=992?page_Width_Class="md":i>=768?page_Width_Class="sm":(page_Width_Class="xs",gridsPerRow=4,small_tile_size=Math.floor((i+e)/gridsPerRow)),medium_tile_size=2*small_tile_size,big_tile_size=2*medium_tile_size}function noBigTileInXS(){if("xs"==page_Width_Class)for(var e in tiles)tiles[e].size="big"==tiles[e].size?"medium":tiles[e].size}function makeGrids(){fillCapacity=0;for(var e in tiles)"small"==tiles[e].size?fillCapacity+=1:"medium"==tiles[e].size?fillCapacity+=4:"rectangle"==tiles[e].size?fillCapacity+=8:"big"==tiles[e].size&&(fillCapacity+=16);var i=gridsPerRow*Math.ceil(fillCapacity/gridsPerRow)*2;grids={};for(var l=0,t=1,e=1;i>=e;e++){l++,l>gridsPerRow&&(l=1,t++);var s={};s.indX=l,s.indY=t,s.id=l+"x"+t,s.occupiedBy="none",s.top=(t-1)*small_tile_size,s.left=(l-1)*small_tile_size,s.type="",grids[s.id]=s}}function resetGrids(){for(var e in grids)grids[e].occupiedBy="none",grids[e].type=""}function mapTilesToGrid(){clearSpaceDivPosition=0;var e="";for(var i in tileOrder)e=tileOrder[i],gridId=placeTileOnGrid(tiles[e]),tiles[e].gridId=gridId,tiles[e].width="small"==tiles[e].size?small_tile_size:"medium"==tiles[e].size?medium_tile_size:big_tile_size,tiles[e].height="small"==tiles[e].size?small_tile_size:"big"==tiles[e].size?big_tile_size:medium_tile_size,tiles[e].bgColor=tiles[e].bgColor||colorCodes[Math.floor(Math.random()*colorCodes.length)],tiles[e].top=grids[gridId].top,tiles[e].left=grids[gridId].left,clearSpaceDivPosition=tiles[e].top+tiles[e].height>clearSpaceDivPosition?tiles[e].top+tiles[e].height:clearSpaceDivPosition}function placeTileOnGrid(e){for(var i in grids)if("none"==grids[i].occupiedBy){if("small"==e.size)return grids[i].occupiedBy=e.id,grids[i].type="startGrid",i;if(canItHoldTile(grids[i].id,e.size))return markGridsOccupied(grids[i].id,e.size,e.id),grids[i].type="startGrid",i}console.log("No Grid Avaialble for Tile id="+e.id)}function canItHoldTile(e,i){for(var l="medium"==i?2:4,t="big"==i?4:2,s=grids[e].indX,o=grids[e].indY,n=s+(l-1),a=o+(t-1),r="",d=!1,g=s;n>=g;g++){for(var c=o;a>=c;c++)if(r=g+"x"+c,void 0==grids[r]||void 0==typeof grids[r]||"none"!=grids[r].occupiedBy){d=!0;break}if(d)break}return!d}function markGridsOccupied(e,i,l){for(var t="medium"==i?2:4,s="big"==i?4:2,o=grids[e].indX,n=grids[e].indY,a=o+(t-1),r=n+(s-1),d="",g=o;a>=g;g++)for(var c=n;r>=c;c++)d=g+"x"+c,grids[d].occupiedBy=l}function bindDragAndDrop(){function e(){$(".tileResizeMenu").remove(),$("#"+btn_toggleTileDnD).hasClass("off")?($("#"+btn_toggleTileDnD).removeClass("off").addClass("on"),tileMovementAllowed=!0,container.addClass("movementMode").removeClass("resizeMode"),tileResizeAllowed=!1,$("#"+btn_toggleTileResize).removeClass("on").addClass("off")):($("#"+btn_toggleTileDnD).removeClass("on").addClass("off"),tileMovementAllowed=!1,container.removeClass("movementMode"),reTilify())}var i=null,l=null,t=!1,s=0,o=0;$("body").on("pointerdown",".movementMode .tile",function(e){e.preventDefault(),t||(i=$(this).attr("id"),t=!0,s=e.pageX,o=e.pageY,$(".tile").removeClass("being-dragged"),$(this).addClass("being-dragged"))}),$("body").on("pointerup",function(e){if(t){if(t=!1,$("body").trigger("click"),null!=l&&null!=i){var s=[];for(var o in tileOrder)tileOrder[o]!=i&&(tileOrder[o]==l?(s.push(i),s.push(l)):s.push(tileOrder[o]));s.length!=tileOrder.length?(console.log("length mismatch... Hence this order cannot be taken..."),console.log("current tile order"),console.log(tileOrder),console.log("new tile order"),console.log(s)):tileOrder=s}reTilify(),i=null,l=null,$(".tile").removeClass("being-dragged")}}),$("body").on("pointermove",function(e){if(e.stopPropagation(),tileMovementAllowed&&t&&null!=i){var n=e.pageX-s,a=e.pageY-o;s=e.pageX,o=e.pageY;var r=parseInt($("#"+i).css("left")),d=parseInt($("#"+i).css("top")),g=d+a,c=r+n;for(var f in tiles)if(i!=tiles[f].id&&Math.abs(tiles[f].left-r)<small_tile_size&&Math.abs(tiles[f].top-d)<small_tile_size){$(".tile").removeClass("shift-effect"),l=tiles[f].id,$("#"+l).addClass("shift-effect");break}$("#"+i).css({top:g,left:c})}}),$("#"+btn_toggleTileDnD).on("click",function(){e()})}function enableTileResize(){function e(){$(".tileResizeMenu").remove(),$("#"+btn_toggleTileResize).hasClass("off")?($("#"+btn_toggleTileResize).removeClass("off").addClass("on"),tileResizeAllowed=!0,container.addClass("resizeMode").removeClass("movementMode"),tileMovementAllowed=!1,$("#"+btn_toggleTileDnD).removeClass("on").addClass("off"),reTilify()):($("#"+btn_toggleTileResize).removeClass("on").addClass("off"),tileResizeAllowed=!1,container.removeClass("resizeMode"))}$("#"+btn_toggleTileResize).on("click",function(){e()});var i='<ul class="tileResizeMenu"><li>Small</li><li>Medium</li><li>Big</li><li>Rectangle</li></ul>';$("body").on("click",".resizeMode .tile",function(e){$(".tileResizeMenu").remove();var l=parseInt($(this).css("top"))+20,t=parseInt($(this).css("left"))+20;$(i).attr("data-tileID",$(this).attr("id")).css({top:l,left:t}).appendTo(container)}),$("body").on("click",".tileResizeMenu li",function(e){var i=$(this).text().toLowerCase(),l=$(this).closest(".tileResizeMenu").attr("data-tileID");tiles[l].size!=i&&(tiles[l].size=i,reTilify())})}var container=$(this),containerWidth=container.width(),tileOrder=TM.tileOrder,tiles=TM.tiles,grids={},gridsPerRow=0,page_Width_Class="xs",small_tile_size=0,medium_tile_size=0,big_tile_size=0,clearSpaceDivPosition=200,tileMovementAllowed=!1,tileResizeAllowed=!1,colorCodes=["#632F00","#B01E00","#C1004F","#4617B4","#008287","#199900","#00C13F","#FF2E12","#FF1D77","#AA40FF","#1FAEFF","#000","#00A3A3","#FE7C22"];init(),$("body").on("click",".tile a",function(e){(tileMovementAllowed||tileResizeAllowed)&&e.preventDefault()})})}}(jQuery);