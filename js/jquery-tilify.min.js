$.ajaxSetup({cache:!0});var tile_plugins={};!function(e){e.fn.tilify=function(i,t,o){return this.each(function(){function n(){f(),c(),v(),g(),s(),r(),d(),C(),y()}function l(){u(),g(),s(),r()}function s(){var e="";b.addClass("tiles-container "+k);var i;for(var t in I)i=I[t],e+='<div id="'+i.id+'" class="tile '+i.size+'" style="top:'+i.top+"px; left:"+i.left+'px;" data-gridid="'+i.gridId+'" ><a class="tileInnerContainer" target="_blank" href="'+(i.link||"javascript:void(0)")+'" style="background: '+i.bgColor+';" >',"font"==i.iconType?e+='<span class="fontIcon '+i.icon+'"></span>':"live"==i.iconType?(e+='<div class="live">',void 0!=i.liveImgUrls&&(e+='<img  class="fontImg" src="'+i.liveImgUrls[0]+'" />'),void 0!=i.liveTxts&&(e+='<span class="liveTxt" style="color:'+i.fontColor+'">'+i.liveTxts[0]+"</span>"),e+="</div>"):"plugin"==i.iconType&&(e+='<div class="plugin"></div>'),e+='<label class="name">'+i.name+"</label>",e+="</a></div>";e+='<div style="position:absolute; left: 10px; right: 10px; height: 80px; top: '+(R+50)+'px" ></div>',b.html(e),a()}function a(){for(var i in I)if("plugin"==I[i].iconType){var t="tile_plugins/"+I[i].id+"/index.js";setTimeout(function(){e.getScript(t,function(e,i,t){})},100)}}function r(){e(".tile.small").css({width:F,height:F}),e(".tile.medium").css({width:w,height:w}),e(".tile.big").css({width:B,height:B}),e(".tile.rectangle").css({width:B,height:w}),e(".tile .fontIcon").each(function(){var i=e(this).closest(".tile").height();e(this).css({"font-size":i/2+"px","margin-top":i/8+"px"})})}function d(){var i=["slideInDown","slideInLeft","slideInRight","slideInUp","rotateIn","rollIn","zoomIn"],t=["fadeIn"];e(".tile .live").each(function(){function o(){A||D||(r=(r+1)%d,f=i[Math.floor(Math.random()*i.length)],e("#"+l).find(".fontImg").attr("src",s[r]).removeClass().addClass("fontImg animated "+f)),setTimeout(o,c)}function n(){A||D||(v=(v+1)%u,f=t[Math.floor(Math.random()*t.length)],e("#"+l).find(".liveTxt").text(a[v]).removeClass().addClass("liveTxt animated "+f)),setTimeout(n,c)}var l=e(this).closest(".tile").attr("id"),s=I[l].liveImgUrls,a=I[l].liveTxts;if(void 0!=s&&s.length>1){var r=0,d=s.length,f="",c=2500+Math.round(Math.random()*(5e3/d));o()}if(void 0!=a&&a.length>1){var v=0,u=a.length,f="",c=2500+Math.round(Math.random()*(5e3/u));n()}})}function f(){var e=20,i=M-e;k="xs";T=12,F=Math.floor(i/T),i>=1200?(k="lg",T=16,F=Math.floor(i/T)):i>=992?k="md":i>=768?k="sm":(k="xs",T=4,F=Math.floor((i+e)/T)),w=2*F,B=2*w}function c(){if("xs"==k)for(var e in I)I[e].size="big"==I[e].size?"medium":I[e].size}function v(){fillCapacity=0;for(var e in I)"small"==I[e].size?fillCapacity+=1:"medium"==I[e].size?fillCapacity+=4:"rectangle"==I[e].size?fillCapacity+=8:"big"==I[e].size&&(fillCapacity+=16);var i=T*Math.ceil(fillCapacity/T)*2;x={};for(var t=0,o=1,e=1;i>=e;e++){t++,t>T&&(t=1,o++);var n={};n.indX=t,n.indY=o,n.id=t+"x"+o,n.occupiedBy="none",n.top=(o-1)*F,n.left=(t-1)*F,n.type="",x[n.id]=n}}function u(){for(var e in x)x[e].occupiedBy="none",x[e].type=""}function g(){R=0;var e="";for(var i in z)e=z[i],gridId=p(I[e]),I[e].gridId=gridId,I[e].width="small"==I[e].size?F:"medium"==I[e].size?w:B,I[e].height="small"==I[e].size?F:"big"==I[e].size?B:w,I[e].bgColor=I[e].bgColor||X[Math.floor(Math.random()*X.length)],I[e].top=x[gridId].top,I[e].left=x[gridId].left,R=I[e].top+I[e].height>R?I[e].top+I[e].height:R}function p(e){for(var i in x)if("none"==x[i].occupiedBy){if("small"==e.size)return x[i].occupiedBy=e.id,x[i].type="startGrid",i;if(h(x[i].id,e.size))return m(x[i].id,e.size,e.id),x[i].type="startGrid",i}console.log("No Grid Avaialble for Tile id="+e.id)}function h(e,i){for(var t="medium"==i?2:4,o="big"==i?4:2,n=x[e].indX,l=x[e].indY,s=n+(t-1),a=l+(o-1),r="",d=!1,f=n;s>=f;f++){for(var c=l;a>=c;c++)if(r=f+"x"+c,void 0==x[r]||void 0==typeof x[r]||"none"!=x[r].occupiedBy){d=!0;break}if(d)break}return!d}function m(e,i,t){for(var o="medium"==i?2:4,n="big"==i?4:2,l=x[e].indX,s=x[e].indY,a=l+(o-1),r=s+(n-1),d="",f=l;a>=f;f++)for(var c=s;r>=c;c++)d=f+"x"+c,x[d].occupiedBy=t}function C(){function i(){e(".tileResizeMenu").remove(),e("#"+t).hasClass("off")?(e("#"+t).removeClass("off").addClass("on"),A=!0,b.addClass("movementMode").removeClass("resizeMode"),D=!1,e("#"+o).removeClass("on").addClass("off")):(e("#"+t).removeClass("on").addClass("off"),A=!1,b.removeClass("movementMode"),l())}var n=null,s=null,a=!1,r=0,d=0;e("body").on("pointerdown",".movementMode .tile",function(i){i.preventDefault(),a||(n=e(this).attr("id"),a=!0,r=i.pageX,d=i.pageY,e(".tile").removeClass("being-dragged"),e(this).addClass("being-dragged"))}),e("body").on("pointerup",function(i){if(a){if(a=!1,e("body").trigger("click"),null!=s&&null!=n){var t=[];for(var o in z)z[o]!=n&&(z[o]==s?(t.push(n),t.push(s)):t.push(z[o]));t.length!=z.length?(console.log("length mismatch... Hence this order cannot be taken..."),console.log("current tile order"),console.log(z),console.log("new tile order"),console.log(t)):z=t}l(),n=null,s=null,e(".tile").removeClass("being-dragged")}}),e("body").on("pointermove",function(i){if(i.stopPropagation(),A&&a&&null!=n){var t=i.pageX-r,o=i.pageY-d;r=i.pageX,d=i.pageY;var l=parseInt(e("#"+n).css("left")),f=parseInt(e("#"+n).css("top")),c=f+o,v=l+t;for(var u in I)if(n!=I[u].id&&Math.abs(I[u].left-l)<F&&Math.abs(I[u].top-f)<F){e(".tile").removeClass("shift-effect"),s=I[u].id,e("#"+s).addClass("shift-effect");break}e("#"+n).css({top:c,left:v})}}),e("#"+t).on("click",function(){i()}),i()}function y(){function i(){e(".tileResizeMenu").remove(),e("#"+o).hasClass("off")?(e("#"+o).removeClass("off").addClass("on"),D=!0,b.addClass("resizeMode").removeClass("movementMode"),A=!1,e("#"+t).removeClass("on").addClass("off"),l()):(e("#"+o).removeClass("on").addClass("off"),D=!1,b.removeClass("resizeMode"))}i(),e("#"+o).on("click",function(){i()});var n='<ul class="tileResizeMenu"><li>Small</li><li>Medium</li><li>Big</li><li>Rectangle</li></ul>';e("body").on("click",".resizeMode .tile",function(i){e(".tileResizeMenu").remove();var t=parseInt(e(this).css("top"))+20,o=parseInt(e(this).css("left"))+20;e(n).attr("data-tileID",e(this).attr("id")).css({top:t,left:o}).appendTo(b)}),e("body").on("click",".tileResizeMenu li",function(i){var t=e(this).text().toLowerCase(),o=e(this).closest(".tileResizeMenu").attr("data-tileID");I[o].size!=t&&(I[o].size=t,l())})}var b=e(this),M=b.width(),z=i.tileOrder,I=i.tiles,x={},T=0,k="xs",F=0,w=0,B=0,R=200,A=!1,D=!1,X=["#632F00","#B01E00","#C1004F","#4617B4","#008287","#199900","#00C13F","#FF2E12","#FF1D77","#AA40FF","#1FAEFF","#000","#00A3A3","#FE7C22"];n(),e("body").on("click",".tile a",function(e){(A||D)&&e.preventDefault()})})}}(jQuery);